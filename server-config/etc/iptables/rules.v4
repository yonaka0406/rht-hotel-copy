# Generated by iptables-save v1.8.10 (nf_tables) on Fri Apr 25 14:20:39 2025
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]

# Allow established and related connections
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Allow loopback
-A INPUT -i lo -j ACCEPT

# Rate limiting for SSH connections
-A INPUT -p tcp --dport 22 -m state --state NEW -m recent --set --name SSH
-A INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 60 --hitcount 4 --name SSH -j DROP
-A INPUT -p tcp --dport 22 -j ACCEPT

# PostgreSQL connection limiting
-A INPUT -p tcp --dport 5432 -m state --state NEW -m recent --set --name PSQL
-A INPUT -p tcp --dport 5432 -m state --state NEW -m recent --update --seconds 60 --hitcount 20 --name PSQL -j DROP
-A INPUT -p tcp --dport 5432 -j ACCEPT

# HTTP/HTTPS traffic
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp --dport 443 -j ACCEPT

# Block known malicious IPs
-A INPUT -s 195.26.255.172/32 -j DROP
-A INPUT -s 46.105.97.78/32 -j DROP
-A INPUT -s 194.0.234.149/32 -j DROP
-A INPUT -s 194.0.234.153/32 -j DROP
-A INPUT -s 196.251.90.184/32 -j DROP

COMMIT
# Completed on Fri Apr 25 14:20:39 2025