import{I as l,a6 as k}from"./index-D1uxBxpa.js";const h=l([]),u=l([]),R=l([]),p=l(null),T=l({});function E(){const i=o=>{const c=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),r=String(o.getDate()).padStart(2,"0");return`${c}-${s}-${r}`};return{availableRooms:h,reservedRooms:u,holdReservations:R,reservationId:p,reservationDetails:T,setReservationId:o=>{p.value=o},getReservationId:()=>p.value,fetchReservation:async o=>{try{const c=localStorage.getItem("authToken"),s=`/api/reservation/info?id=${o}`,r=await fetch(s,{method:"GET",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"}}),a=await r.json();if(!r.ok)throw new Error("Failed to fetch reservation details");if(a.message){console.error(a.message),T.value={};return}Array.isArray(a.reservation)&&a.reservation.forEach(e=>{e.check_in=i(new Date(e.check_in)),e.check_out=i(new Date(e.check_out)),e.date=i(new Date(e.date))}),T.value=a,p.value=o}catch(c){return console.error("Error fetching reservation:",c),T.value={},null}},fetchAvailableRooms:async(o,c,s)=>{try{const r=localStorage.getItem("authToken"),a=`/api/reservation/available-rooms?hotel_id=${o}&start_date=${c}&end_date=${s}`,e=await fetch(a,{method:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!e.ok){const v=await e.text();throw console.error("fetchAvailableRooms API Error:",e.status,e.statusText,v),new Error(`API returned an error: ${e.status} ${e.statusText} ${v}`)}const t=await e.json();return t&&t.availableRooms&&Array.isArray(t.availableRooms)?h.value=t.availableRooms:t&&t.message==="No available rooms for the specified period."?h.value=[]:t&&Object.keys(t).length===0?h.value=[]:(console.error("Invalid API response format:",t),h.value=[]),e}catch(r){console.error("Failed to fetch available rooms",r),h.value=[]}},fetchReservedRooms:async(o,c,s)=>{try{const r=localStorage.getItem("authToken"),a=`/api/reservation/reserved-rooms?hotel_id=${o}&start_date=${c}&end_date=${s}`,e=await fetch(a,{method:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!e.ok){const v=await e.text();throw console.error("fetchReservedRooms API Error:",e.status,e.statusText,v),new Error(`API returned an error: ${e.status} ${e.statusText} ${v}`)}const t=await e.json();return t&&t.reservedRooms&&Array.isArray(t.reservedRooms)?u.value=t.reservedRooms:t&&t.message==="No reserved rooms for the specified period."?u.value=[]:t&&Object.keys(t).length===0?u.value=[]:(console.error("Invalid API response format:",t),u.value=[]),e}catch(r){console.error("Failed to fetch reserved rooms",r),u.value=[]}},fetchMyHoldReservations:async()=>{try{const o=localStorage.getItem("authToken"),s=await fetch("/api/reservation/hold-list",{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!s.ok){const a=await s.text();throw console.error("fetchMyHoldReservations API Error:",s.status,s.statusText,a),new Error(`API returned an error: ${s.status} ${s.statusText} ${a}`)}const r=await s.json();if(r.reservations){const a={};r.reservations.forEach(e=>{const t=`${e.hotel_id}-${e.reservation_id}-${e.client_name}-${e.check_in}-${e.check_out}-${e.number_of_people}`;a[t]||(a[t]={hotel_id:e.hotel_id,reservation_id:e.reservation_id,client_name:e.client_name,check_in:i(new Date(e.check_in)),check_out:i(new Date(e.check_out)),number_of_people:e.number_of_people})}),R.value=Object.values(a)}return r}catch(o){console.error("Error fetching hold reservations:",o)}}}}const f=l([]),_=l(null),d=l(null),g=l([]);function b(){const i=async()=>{try{const n=localStorage.getItem("authToken"),m=await fetch("/api/hotel-list",{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});f.value=await m.json(),f.value.length>0&&!d.value&&(d.value=f.value[0].id)}catch(n){console.error("Failed to fetch hotels",n)}},y=async()=>{try{const n=localStorage.getItem("authToken"),m=await fetch(`/api/hotel-rooms/${d.value}`,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});g.value=await m.json(),_.value=f.value.find($=>$.id===d.value)}catch(n){console.error("Failed to fetch hotel rooms",n)}};return k(d,n=>{n&&y()}),{hotels:f,selectedHotel:_,selectedHotelId:d,selectedHotelRooms:g,fetchHotels:i,fetchHotel:y}}export{E as a,b as u};
//# sourceMappingURL=useHotelStore-CcnjKFIZ.js.map
